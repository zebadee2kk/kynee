{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://kynee.dev/schemas/inventory.schema.json",
  "title": "KYNEĒ Asset Inventory",
  "description": "Schema for network asset inventory generated by KYNEĒ agents",
  "type": "object",
  "properties": {
    "engagement_id": {
      "type": "string",
      "description": "Unique identifier for the engagement",
      "pattern": "^ENG-[0-9]{4}-[0-9]{3}$"
    },
    "agent_id": {
      "type": "string",
      "description": "Agent UUID",
      "format": "uuid"
    },
    "scan_timestamp": {
      "type": "string",
      "description": "Scan start time (ISO 8601 UTC)",
      "format": "date-time"
    },
    "scan_duration_seconds": {
      "type": "number",
      "description": "Total scan duration",
      "minimum": 0
    },
    "scan_type": {
      "type": "string",
      "description": "Type of inventory scan",
      "enum": ["network", "wireless", "bluetooth"]
    },
    "scope": {
      "type": "object",
      "description": "Scan scope (from RoE)",
      "properties": {
        "cidr_ranges": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^([0-9]{1,3}\\.){3}[0-9]{1,3}/[0-9]{1,2}$"
          }
        },
        "ssids": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "assets": {
      "type": "array",
      "description": "Discovered assets",
      "items": {
        "type": "object",
        "properties": {
          "asset_id": {
            "type": "string",
            "format": "uuid"
          },
          "ip_address": {
            "type": "string",
            "format": "ipv4"
          },
          "mac_address": {
            "type": "string",
            "pattern": "^([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}$"
          },
          "hostname": {
            "type": "string"
          },
          "vendor": {
            "type": "string",
            "description": "Vendor from MAC OUI lookup"
          },
          "os_guess": {
            "type": "string",
            "description": "Operating system guess"
          },
          "open_ports": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "port": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 65535
                },
                "protocol": {
                  "type": "string",
                  "enum": ["tcp", "udp"]
                },
                "service": {
                  "type": "string"
                },
                "version": {
                  "type": "string"
                },
                "state": {
                  "type": "string",
                  "enum": ["open", "closed", "filtered"]
                }
              },
              "required": ["port", "protocol", "state"]
            }
          },
          "last_seen": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": ["asset_id", "last_seen"]
      }
    },
    "summary": {
      "type": "object",
      "description": "Scan summary statistics",
      "properties": {
        "total_assets": {
          "type": "integer",
          "minimum": 0
        },
        "total_open_ports": {
          "type": "integer",
          "minimum": 0
        },
        "unique_services": {
          "type": "integer",
          "minimum": 0
        }
      }
    }
  },
  "required": [
    "engagement_id",
    "agent_id",
    "scan_timestamp",
    "scan_type",
    "assets"
  ],
  "additionalProperties": false
}
