{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://kynee.dev/schemas/findings.schema.json",
  "title": "KYNEĒ Security Findings",
  "description": "Schema for security findings generated by KYNEĒ agents during authorized penetration tests",
  "type": "object",
  "properties": {
    "engagement_id": {
      "type": "string",
      "description": "Unique identifier for the engagement (links to RoE)",
      "pattern": "^ENG-[0-9]{4}-[0-9]{3}$",
      "examples": ["ENG-2026-042"]
    },
    "agent_id": {
      "type": "string",
      "description": "Unique device identifier (UUID)",
      "format": "uuid"
    },
    "finding_id": {
      "type": "string",
      "description": "Unique finding identifier",
      "format": "uuid"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp (UTC)",
      "format": "date-time"
    },
    "tool": {
      "type": "string",
      "description": "Tool that generated the finding",
      "examples": ["nmap", "airodump-ng", "hcitool", "flipper_zero"]
    },
    "category": {
      "type": "string",
      "description": "Finding category",
      "enum": [
        "network_discovery",
        "vulnerability",
        "credential",
        "wireless",
        "bluetooth",
        "physical",
        "configuration",
        "information_disclosure"
      ]
    },
    "severity": {
      "type": "string",
      "description": "CVSS-aligned severity rating",
      "enum": ["informational", "low", "medium", "high", "critical"]
    },
    "cvss_score": {
      "type": "number",
      "description": "CVSS v3.1 base score (0.0-10.0)",
      "minimum": 0.0,
      "maximum": 10.0
    },
    "title": {
      "type": "string",
      "description": "Short title for the finding",
      "maxLength": 200
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the finding"
    },
    "target": {
      "type": "object",
      "description": "Target asset information",
      "properties": {
        "ip_address": {
          "type": "string",
          "format": "ipv4"
        },
        "mac_address": {
          "type": "string",
          "pattern": "^([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}$"
        },
        "hostname": {
          "type": "string"
        },
        "port": {
          "type": "integer",
          "minimum": 1,
          "maximum": 65535
        },
        "protocol": {
          "type": "string",
          "enum": ["tcp", "udp", "icmp"]
        },
        "service": {
          "type": "string"
        }
      }
    },
    "evidence": {
      "type": "object",
      "description": "Supporting evidence (tool-specific)",
      "additionalProperties": true
    },
    "remediation": {
      "type": "string",
      "description": "Recommended remediation steps"
    },
    "references": {
      "type": "array",
      "description": "External references (CVEs, advisories, etc.)",
      "items": {
        "type": "string",
        "format": "uri"
      }
    },
    "false_positive": {
      "type": "boolean",
      "description": "Mark as false positive (reviewed by operator)",
      "default": false
    },
    "verified": {
      "type": "boolean",
      "description": "Manually verified by operator",
      "default": false
    }
  },
  "required": [
    "engagement_id",
    "agent_id",
    "finding_id",
    "timestamp",
    "tool",
    "category",
    "severity",
    "title",
    "description"
  ],
  "additionalProperties": false
}
