{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://kynee.dev/schemas/findings.schema.json",
  "title": "KYNEĒ Security Findings",
  "description": "Schema for security assessment findings reported by KYNEĒ agents",
  "type": "object",
  "properties": {
    "finding_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for this finding"
    },
    "engagement_id": {
      "type": "string",
      "description": "Engagement this finding belongs to"
    },
    "agent_id": {
      "type": "string",
      "description": "Agent device UUID that discovered this finding"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When the finding was discovered (ISO 8601 UTC)"
    },
    "tool": {
      "type": "string",
      "description": "Tool used to discover this finding",
      "examples": ["nmap", "airodump-ng", "hcitool", "flipper-zero"]
    },
    "category": {
      "type": "string",
      "enum": [
        "network",
        "wireless",
        "bluetooth",
        "physical",
        "credential",
        "vulnerability",
        "misconfiguration"
      ]
    },
    "severity": {
      "type": "string",
      "enum": ["informational", "low", "medium", "high", "critical"]
    },
    "title": {
      "type": "string",
      "description": "Short title for this finding",
      "maxLength": 200
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the finding"
    },
    "target": {
      "type": "object",
      "properties": {
        "ip_address": {"type": "string", "format": "ipv4"},
        "mac_address": {"type": "string", "pattern": "^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$"},
        "hostname": {"type": "string"},
        "ssid": {"type": "string"},
        "bssid": {"type": "string"},
        "port": {"type": "integer", "minimum": 1, "maximum": 65535},
        "protocol": {"type": "string", "examples": ["tcp", "udp"]}
      }
    },
    "evidence": {
      "type": "object",
      "description": "Supporting evidence for this finding",
      "properties": {
        "raw_output": {"type": "string"},
        "screenshot_path": {"type": "string"},
        "pcap_path": {"type": "string"},
        "metadata": {"type": "object"}
      }
    },
    "cvss_score": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 10.0,
      "description": "CVSS v3.1 score if applicable"
    },
    "cve_id": {
      "type": "string",
      "pattern": "^CVE-[0-9]{4}-[0-9]+$",
      "description": "CVE identifier if applicable"
    },
    "remediation": {
      "type": "string",
      "description": "Recommended remediation steps"
    },
    "references": {
      "type": "array",
      "items": {
        "type": "string",
        "format": "uri"
      },
      "description": "External references (CVE, vendor advisories, etc.)"
    },
    "status": {
      "type": "string",
      "enum": ["new", "confirmed", "false_positive", "mitigated", "accepted_risk"],
      "default": "new"
    }
  },
  "required": [
    "finding_id",
    "engagement_id",
    "agent_id",
    "timestamp",
    "tool",
    "category",
    "severity",
    "title",
    "description"
  ],
  "additionalProperties": false
}
